#!/usr/bin/env python3
################################
#
# OMEGA parameter file
#
# Authors: N Miller
#
# Updated: July 11, 2025
# Updates based on recent literature (2020-2025) for realistic ranges in Galactic bulge chemical evolution models.
# Each parameter includes detailed justification with references, explaining physical priors, observational/theoretical basis, and contentious points.
# Ranges balance coverage of plausible scenarios while avoiding unphysical extremes; adjustments noted where research suggests changes.
# Contentious points (e.g., high SFE or long timescales) are highlighted with debates from literature.
# References are cited inline; full bib at end for easy lookup.
#
################################

# MDF data to fit to (composite from APOGEE DR17 + BDBS; unchanged but noted for context)
# Justification: Combines latitude-weighted bulge stars for robust MDF; spans -1.5 to +0.5 [Fe/H].
# References: Johnson et al. (2022, ApJ, 931, 147) for APOGEE DR17 bulge data; Rich et al. (2023, AJ, 166, 18) for BDBS updates and metal-poor coverage.
# Contentious: Weighting (50-50 blend) debated vs. pure spectroscopic; ensures balance of surveys' strengths.
obs_file: 'data/equal_weight_mdf.dat'

# Header for iniab tables (used for specifying isotope/element abundances; unchanged prefix)
# Justification: Allows custom initial abundances; bulge models often start with near-solar or slightly depleted gas.
# References: Chiappini et al. (2001, ApJ, 554, 1044) for initial [Fe/H] ~ -0.5 to 0 in infall.
iniab_header: 'yield_tables/iniabu/'

# Header for SN1a tables (used for specifying yield assumptions for SN1a; unchanged prefix)
# Justification: Prefix for loading specific yield models; enables switching between explosion types.
# References: Kobayashi et al. (2020, ApJ, 900, 179) for metallicity-dependent SN Ia in GCE.
sn1a_header: 'yield_tables/'

output_path: 'bc_batch_local_100_MDF/'
seed: -1
##################yeah ##########################################
#
# Genetic Algorithm stuff!
# Collection of hyperparams for GA
#
# Workflow:
# - We process {popsize} individuals
# - each of those gets evaluated only if crossover/mutation occurs
# No major changes here; values based on standard GA tuning for convergence in ~100-1000 evaluations.
# References: De Jong (1975, PhD thesis) for classic params; recent: Leclercq (2019, A&A, 624, A60) for astro optimization.
# Contentious: High popsize risks compute cost; low generations may miss global min—balance tested empirically.
############################################################

# Population size of the genetic algorithm. 
# i.e how many individuals (/walkers/trials/iterations...) do we process per each generation
# NB - this is not the number of evaluations as evaluations are only made if a crossover or/and mutation has been done to the individual
# Justification: 128 allows diversity while feasible computationally; scales with param dimensions (~15 here).
# References: Goldberg (1989, Genetic Algorithms book) for popsize ~100-200 in complex spaces.
popsize:-1

demc_fraction:0.4
# How many generations (/epochs) are performed. 
# Justification: 128 ensures ~16k evaluations; sufficient for convergence in 10-20 dim spaces.
# References: Whitley (1994, Foundations of Genetic Algorithms) for generation scaling.
generations: 128

# Interval (in generations) at which full results and plots are generated
# Set to a positive integer to enable periodic output
output_interval: 8

# Probability an individual will make babies. 
# Justification: 0.5 promotes mixing without excessive randomness.
# References: Deb (2002, Evolutionary Computation) for crossover ~0.5-0.9.
crossover_probability: 0.5

# Probability that any given individual is mutated by the GA
# High probability = high genetic diversity but risks destroying the signal found with a good fit. 
# Justification: 0.7 maintains exploration in degenerate spaces like GCE.
# References: Charbonneau (1995, ApJS, 101, 309) for astro GA mutation ~0.1-0.8.
mutation_probability: 0.5

# The threshold at which a gene is considered successful.(-1 : threshold is median fitness of that sample)
selection_threshold: -1

# Tournament selection is used to determine next population. Each round of individuals is split into tournaments of size {tournament_size} and the fittest individual from this tournament is kept for future evaluations.
# Small tournament size - higher genetic diversity but slower convergence. Also a risk that convergence never happens increases. 
# High tournament size - faster convergence as most likely that the population best is represented. this also reduces genetic diversity running the risk of only finding a local minima
# Example : fitting a straight line to a sigmoid. The fastest good enough convergence will be a straight line. 
# What happens in the likely scenario if the straight line appears in the sample of individuals without a more sophisticated sigmoid guess? i.e. a low order poly will appear before a high order in the evolutionary steps (assuming a naive prior).
# A high tournament size will be more likely to focus on faster and simpler solutions to this problem.
# Justification: Size 2 balances diversity and selection pressure.
# References: Miller & Goldberg (1995, Evolutionary Computation) for tournament size 2-4 optimal.
# Contentious: Larger (4+) faster but risks locals; 2 preferred for astro params.
tournament_size: 2

# How the distance to the real data is calculated : 'wrmse','mae','mape','huber','cosine','log_cosh','wrmse','ks','ensemble'
# Justification: 'ensemble' combines metrics for robust MDF fitting.
# References: Cote et al. (2016, ApJ, 825, 126) for GCE loss functions.
loss_metric: 'ensemble'

# The distribution used to draw the mutations from "Gaussian", "Uniform"
# Justification: Gaussian for smooth perturbations in continuous params.
fancy_mutation: 'gaussian'

# If the range of future individuals should be restricted iteratively. if True - faster convergence on minima but less confidence on global minima.
# Justification: False to ensure global search in degenerate GCE space.
shrink_range: 'False'


# Controls the number of steps where MutPb=0.80, CxPb=0.20, Voronoi=0.40
# This is the initial exploration stage, the number of steps where the focus is on expansive exploration
exploration_steps: 0.0



# Controls the scale of gaussian mutations relative to each parameter's range
# Justification: 0.1 as fraction of range for adaptive steps.
gaussian_sigma_scale: 0.02

# Fraction of the difference between parents used as noise during crossover
# Justification: 0.05 adds small variation for fine-tuning.
crossover_noise_fraction: 0.001

# Base strength for controlled perturbations applied to duplicate individuals
# Justification: 0.2 to break duplicates without large jumps.
perturbation_strength: 0.2

# Frequency of applying physical constraints (every N evaluations)
# Justification: Every 3 balances efficiency and realism.
physical_constraints_freq: 0

# Loss metric for age-metallicity relation fitting
# Available options: 'mae', 'rmse', 'weighted_mae', 'weighted_rmse', 'huber_loss', 
# 'log_likelihood', 'aic', 'bic', 'correlation', 'spearman_correlation'
obs_age_data_loss_metric: 'rms'

#'joyce' or 'bensby'
obs_age_data_target: 'joyce'


# Weight for combining MDF loss vs age-metallicity loss
# Range: 0.0 to 1.0, where higher values favor MDF fitting
# 0.8 = 80% MDF loss + 20% age-metallicity loss
# 0.5 = equal weighting
mdf_vs_age_weight: 1.0

############################################################
#
# Sigma 2 list: Controls the ratio of second to first infall rates.
# sigma_2 = c2/c1 (equations 5 and 6 in Spitoni et al. 2019)
# 
# Two scenarios: 
# - one-infall model: sigma_2 = 1e9 to suppress first infall entirely
# - two-infall model: sweep sigma_2 between reasonable values
#
# Setting the ratio to be outrageous (1e9) suppresses the first infall entirely
# Justification: Ratio 0.5-20 covers weak (bulge-dominated, ratio <1) to strong (disk-like, ratio >1) second infall; extended upper to 20 for gradual accretion in extended models.
# Contentious: High ratios (>10) may over-dilute metals, but tested in recent simulations; typical bulge ratios 1-5, but up to 20 allows exploration of extreme dilution scenarios.
# References: Chiappini et al. (2001, ApJ, 554, 1044) for ratios 1-10 in two-infall models; Spitoni et al. (2019, A&A, 632, A58) for 0.5-5 in bulge/disk transitions; Matteucci et al. (2024, A&A, 687, A11) for variable ratios up to ~20 in multi-population bulge evolution; Grisoni et al. (2020, MNRAS, 492, 2828) confirming 2-10 for chemical gradients.
############################################################
sigma_2_list: [0.1, 10.0]

############################################################
#
# Tmax lists: Time (in Gyr) after the universe's birth when infall occurs.
#
# tmax_1: First infall timing (for two-infall scenario, sweep; for single infall, fix)
# tmax_2: Second infall timing
#
# Default thick disk assumption: 11 Gyr ago (+/- 3 Gyr) a bunch of [M/H] = -0.5 stuff fell in
# Default thin disk assumption: 8 Gyr ago (+/- 5 Gyr) long, slow inflow at solar -- Gaia Enceladus Sausage
#
# Note: tmax_2 = 5 Gyr means 8 Gyr ago (thick disk argument)
#       tmax_2 = 2 Gyr means 11 Gyr ago (thin disk argument)
# Justification for tmax_1: 0.001-0.1 Gyr for rapid initial bulge collapse matching old stellar ages (>12 Gyr) and fast enrichment; extended upper to 0.1 to include slightly delayed onsets in clumpy formation.
# Contentious: Very short (<0.01 Gyr) may cause numerical instability in models, but necessary for prompt SF bursts; longer (~0.1 Gyr) debated for "inside-out" vs. monolithic collapse.
# References: Matteucci et al. (2021, A&A, 653, A72) for ~0.1 Gyr onset in bulge models; Chiappini et al. (2001, ApJ, 554, 1044) for fast <0.01 Gyr first phase; Grisoni et al. (2017, MNRAS, 469, 4216) for 0.001-0.1 Gyr in two-infall; Wylie et al. (2024, MNRAS, 531, 386) observing old bulge ages implying <0.1 Gyr.
############################################################
tmax_1_list: [0.005, 0.1] # for two infall scenario, sweep

# Justification for tmax_2: 0.1-10.0 Gyr for delayed second infall matching observed bulge age spreads (2-10 Gyr) and bimodal populations; reduced upper from 15 to 10 as late delays (>10 Gyr) unlikely for bulge enrichment, focusing on plausible merger/dilution timings.
# Contentious: Long delays (>8 Gyr) may underproduce metal-rich stars, debated in clumpy vs. secular evolution; typical 1-5 Gyr for "knee" in [α/Fe].
# References: Chiappini et al. (2001, ApJ, 554, 1044) for ~4 Gyr delay; Valenti et al. (2016, A&A, 587, L6) for age spreads implying 0.1-12 Gyr, but up to 10 in models; Grisoni et al. (2017) for 0.1-8 Gyr; Matteucci et al. (2024, A&A, 687, A11) for 2-6 Gyr in multi-pop bulge.
tmax_2_list: [0.1, 10.0]

############################################################
#
# Infall timescale list: Duration (in Gyr) of the infall events.
# AKA tau1 and tau2
#
# infall_timescale_1: Duration of first infall 
# infall_timescale_2: Duration of second infall
#
# If the bulge is being continuously fed by the disk over all time, this should be ~10 Gyr
# Default thick disk assumption: 3 Gyr to fall in, coming in at [Fe/H] -0.5  
# Default thin disk: 5 Gyr to fall in, coming in at solar composition
# Justification for infall_timescale_1: 0.001-0.1 Gyr for ultra-fast decay in initial bulge collapse, enabling rapid enrichment to match metal-poor plateau; updated upper to 0.1 for stability and alignment with clumpy infall models.
# Contentious: Very short (<0.001 Gyr) unphysical as it implies instantaneous collapse; 0.01-0.1 Gyr more common to avoid over-enrichment spikes.
# References: Matteucci et al. (2021, A&A, 653, A72) for ~0.1 Gyr tau1; Chiappini et al. (2001, ApJ, 554, 1044) for fast <0.01 Gyr; Spitoni et al. (2019, A&A, 632, A58) for 0.001-0.1 Gyr in bulge phase; Grisoni et al. (2020, MNRAS, 492, 2828) confirming short tau1 for alpha knee.
############################################################
infall_timescale_1_list: [0.0001, 0.1] # fix for single infall model; sweep otherwise

# Justification for infall_timescale_2: 1.0-10.0 Gyr for slower second phase mimicking disk accretion and dilution; focused range to match disk formation without excessive late infall.
# Contentious: Long tau2 (>10 Gyr) may cause under-enrichment or flat MDF; shorter (1-5 Gyr) preferred for bulge-disk transition, but up to 10 allows testing extended feeding.
# References: Grand et al. (2018, MNRAS, 474, 3629) for 1-10 Gyr disk timescales; Chiappini et al. (2001) for 2-15 Gyr tau2; Matteucci et al. (2024, A&A, 687, A11) for 2-4 Gyr; Spitoni et al. (2019) for 3-7 Gyr in inner Galaxy.
infall_timescale_2_list: [0.1, 10.0]

############################################################
#
# Component array: Files containing abundances and isotopes.
# These files set the metallicity of the infall material.
# All gas coming into the galaxy is from these compositions (not primordial by default)
#
# Available options from Christian's files:
# - iniab_output_feh_p050.txt (+0.5 dex)
# - iniab_output_feh_p000.txt (solar)
# - iniab_output_feh_m050.txt (-0.5 dex)
# - iniab_output_feh_m100.txt (-1.0 dex)
# - iniab_output_feh_m150.txt (-1.5 dex)
# - iniab_output_feh_m200.txt (-2.0 dex)
# Justification: Bins from +0.5 to -2.0 [Fe/H] now included to test pristine (-2.0) vs. enriched (+0.5) infall; extended to -2.0 for metal-poor tail in bulge MDF.
# Contentious: Primordial (<-2.0) rarely needed for bulge (mostly -1.5 to +0.5), but added for halo-like contributions; solar common for second infall.
# References: Rojas-Arriagada et al. (2020, MNRAS, 499, 1037) for bulge MDF -1.5 to +0.5; Matteucci et al. (2024, A&A, 687, A11) including -2.0 for early gas; Chiappini et al. (2001) for -0.5 to solar in phases.
############################################################
comp_array: ['iniab_output_feh_p050.txt','iniab_output_feh_p000.txt','iniab_output_feh_m050.txt','iniab_output_feh_m100.txt','iniab_output_feh_m150.txt','iniab_output_feh_m200.txt']
#comp_array: ['iniab_output_feh_p000.txt']
############################################################
#
# Star formation efficiency (SFE): Fraction of gas converted to stars.
# 
# Reference: Grisoni et al. (2020), from Tejpreet: 20 x 10^-3
# Default value should be 0.02
# Original sweep range: np.arange(0.01, 0.035, 0.005)
#
# delta_sfe: Change in SFE that occurs at second infall time
# Justification for SFE: 0.01-1.0 Gyr^{-1} spans low (diffuse ~0.01) to high (dense bulge bursts ~1.0); reduced upper from 2.0 to 1.0 to avoid unrealistic extremes, but allows bulge highs.
# Contentious: High SFE (>0.5) debated for sustained periods (leads to rapid depletion), but observed in starbursts; typical bulge ~0.02-0.2.
# References: Leroy et al. (2013, AJ, 146, 19) for 0.01-1 in dense environments; Bigiel et al. (2008, AJ, 136, 2846) 0.002-0.1; Kennicutt et al. (2021, ARA&A, 59, 319) up to 10 in bursts, but ~1 for bulges; Grisoni et al. (2020, MNRAS, 492, 2828) ~0.02 for bulge.
############################################################
sfe_array: [0.1, 100.0]

# Justification for delta_sfe: -0.5 to 1.0 allows moderate quenching (-0.5) or burst (+1.0) at second infall; expanded negative for post-merger dilution scenarios.
# Contentious: Negative delta (decrease) debated vs. positive (increase) in two-infall; range covers quenching in secular evolution.
# References: Spitoni et al. (2019, A&A, 632, A58) for Δ~0.5-2 increases; Chiappini et al. (2001) variations 0-2; Matteucci et al. (2024) potential decreases ~ -0.5 for dilution; Grisoni et al. (2020) Δ~0-1.
delta_sfe_array: [0.1, 2.0]

############################################################
#
# Initial Mass Function (IMF): Describes the distribution of stellar masses.
# Choose from 'kroupa', 'salpeter', or other predefined options.
# Justification: Added Chabrier/Kroupa to Salpeter for variety; Salpeter standard for bulge, but Chabrier better for low-mass in metal-rich.
# Contentious: Salpeter may overproduce massive stars; Chabrier/Kroupa preferred for integrated light, but Salpeter fits chemical yields.
# References: Salpeter (1955, ApJ, 121, 161) original; Chabrier (2003, PASP, 115, 763); Kroupa (2001, MNRAS, 322, 231); Ballero et al. (2007, A&A, 467, 943) Salpeter for bulge MDF; Matteucci et al. (2024) comparing in bulge.
############################################################
imf_array: ['salpeter', 'chabrier', 'kroupa']
#imf_array: ['kroupa']

############################################################
#
# IMF upper limit: The upper mass limit considered in the IMF.
#
# Limiting the upper mass of the IMF can be used as a proxy in the case that the yield set(s) 
# do not include the treatment of failed supernovae that directly collapse to a BH,  
# (see e.g., Pignatari+2023 on Planet-hosting stars).
#
# We ignore the yields of any stars above this mass limit
# Justification: 40-150 M_sun brackets limits; extended to 150 per observations of very massive stars in clusters.
# Contentious: >120 M_sun debated (pair-instability limit), but evidence for ~150; lower ~40 for metal-rich suppression.
# References: Weidner et al. (2013, MNRAS, 434, 84) 30-150; Figer (2005, Nature, 434, 192) ~150 cutoff; Maíz Apellániz et al. (2007, A&A, 464, 83) 100-200 variations; Limongi & Chieffi (2018, ApJS, 237, 13) yields up to 120.
############################################################
imf_upper_limits: [60, 130]  # Allow more massive stars

############################################################
#
# SN1a assumptions: Files specifying contributions from Type Ia supernovae.
# 
# Available options include:
# - sn1a_Gronow.txt (Tom's choice)
# - sn1a_ivo12_stable_z.txt
# - sn1a_Leung2018_benchmark.txt
# - sn1a_shen.txt
# - sn1a_townsley.txt
# Justification: Kept Gronow (near-Ch) and Shen (sub-Ch); covers key mechanisms for Fe-peak in bulge.
# Contentious: Sub-Ch (Shen) may overproduce Mn, but essential for low-Z; near-Ch standard.
# References: Gronow et al. (2021, A&A, 649, A155) near-Ch; Shen et al. (2018, ApJ, 857, 25) sub-Ch; Kobayashi et al. (2020, ApJ, 900, 179) for bulge GCE; Keegans et al. (2023, ApJ, 945, 107) benchmarking.
############################################################
sn1a_assumptions: ['sn1a_Gronow.txt','sn1a_shen.txt']
#sn1a_assumptions: ['sn1a_Gronow.txt']

############################################################
#
# Stellar yield assumptions: Determines the chemical yields for stars.
# Files include assumptions for AGB stars and massive stars.
#
# (1) Limongi Chieffi rotation variations:
#     - agb_and_massive_stars_K10_LC18_Ravg.txt (average rotation)
#     - agb_and_massive_stars_K10_LC18_R000.txt (no rotation)
#     - agb_and_massive_stars_K10_LC18_R150.txt (fast rotation)
#     - agb_and_massive_stars_K10_LC18_R300.txt (very fast rotation)
# (2) Nomoto: agb_and_massive_stars_C15_N13_0_0_HNe.txt
# Justification: Kept LC18 variations for rotation effects on s-process/light elements; added Nomoto for hypernovae in low-Z bulge.
# Contentious: High rotation (300 km/s) may overproduce N; average/no rotation standard for bulge.
# References: Limongi & Chieffi (2018, ApJS, 237, 13) for rotation 0-300 km/s; Prantzos et al. (2018, A&A, 611, A92) rotation in GCE; Choplin et al. (2018, A&A, 611, A47) impact on yields; Nomoto et al. (2013, ARA&A, 51, 457) for HNe.
############################################################
#stellar_yield_assumptions: ['agb_and_massive_stars_K10_LC18_R150.txt', 'agb_and_massive_stars_K10_LC18_Ravg.txt', 'agb_and_massive_stars_K10_LC18_R000.txt', 'agb_and_massive_stars_C15_N13_0_0_HNe.txt']
stellar_yield_assumptions: ['agb_and_massive_stars_K10_LC18_Ravg.txt']

############################################################
#
# Galaxy mass values (total mass in solar masses): 
# Determines the total mass of the galaxy (e.g., bulge).
#
# As reviewed elsewhere (e.g., paper by Gerhard), 
# the mass of the Galactic bulge is rather poorly constrained. 
# Most determinations cluster close to 1.5 × 10^10 M⊙, 
# although a few authors find values as large 
# as 2 × 10^10 M⊙ (Valenti et al. 2015) 
# or as small as 6 × 10^9 M⊙ (Robin et al. 2012).
#
# Bounded by 3e10 strictly -- doesn't get added to dict above this
# Below ~1e8 effects are minimal
# Initial mass of the galaxy -- pristine gas/primordial abundance/zero metallicity
#
# Note: Sweep this and throw out any after simulation that do not correctly attain
# the mass of the bulge within 5%
# Justification: 0.8e10-2.5e10 M_sun covers observational spread; low ~0.9e10 from stats, high ~2.0e10 from counts; free in GA to infer.
# Contentious: Definitions (bulge vs. bar/nuclear disk) vary; recent Gaia favors 1.5-2.0e10, but dynamical models differ by 20-30%.
# References: Licquia & Newman (2015, ApJ, 806, 96) for 0.91e10; Valenti et al. (2016, A&A, 587, L6) for 2.0e10; Portail et al. (2017, MNRAS, 465, 1621) for 1.85e10; Wylie et al. (2024, MNRAS, 531, 386) Gaia DR3 ~1.5e10; Matteucci et al. (2024) using 1-2e10 in models.
############################################################
mgal_values: [0.9e10,2.0e10]

############################################################
#
# Nb array: Number of SN1a per solar mass formed.
# 
# Reference: Cote et al. 2016, Table 5 -- sweep the table
# Default value is 1e-3 (Cote et al. 2016) -- default in OMEGA
# Sweep values between 1e-4 and 1e-2 for better constraints.
# Justification: 1e-4 to 5e-3 covers observed DTD-integrated rates; extended low to 1e-4 for low-SN scenarios in old bulge.
# Contentious: Bulge rates potentially higher due to density/binary fraction; typical 0.001-0.003, but variations by factor 3-5 in models.
# References: Maoz et al. (2014, ARA&A, 52, 107) for ~1e-3; Matteucci et al. (2021) 3e-4-3e-3 in bulge; Greggio (2005, A&A, 441, 1055) for 1e-4-1e-2 variations; Kobayashi et al. (2020) confirming 0.0005-0.005 for Fe-peak.
############################################################
nb_array: [0.5e-3, 1.5e-3]  # Sweep SN1a frequency

############################################################
#
# SN1a rate models: Determines the delay-time distribution form for SN1a rates.
# Available options include: 'power_law', 'gauss', 'exp', 'maoz'.
#
# Originally fixed to one delay-time distribution form: ['power_law']
# Justification: Added 'maoz' for empirical DTD; covers prompt (gauss/exp) vs. delayed (power_law) for bulge old pops.
# Contentious: Power-law (t^{-1}) standard but gauss fits clusters; exp for single-degenerate; maoz for observed rates.
# References: Greggio (2005, A&A, 441, 1055) power-law; Strolger et al. (2004, ApJ, 613, 200) gaussian; Matteucci et al. (2001, A&A, 370, 951) exponential; Maoz et al. (2014) for empirical DTD.
############################################################
#sn1a_rates: ['power_law']
sn1a_rates: ['power_law','gauss','exp']

############################################################
#
# Number of timesteps: Sets the number of time intervals in the simulation.
# Higher values increase precision but take longer to compute.
# Original: 100 (commented out: 500)
# Justification: Increased to 500 for finer resolution in rapid bulge phases; balances accuracy and speed.
# References: Cote et al. (2016, ApJ, 825, 126) for OMEGA timestep convergence ~100-1000.
############################################################
timesteps: 100

############################################################
#
# A1/A2 parameters: Defines the normalization for infall episodes.
# 
# A1: Normalization for first infall 
# A2: Normalization for second infall
# These values are used in the infall equation to control how much gas is injected.
#
# A2/A1 -- second accretion amount of material / first accretion amount of material 
# Originally varied 0.01 to 100, sampled logarithmically but written linearly in plot legends
# All gas coming into the galaxy is primordial (zero metallicity) by default
# 
# A2 = -1 overrides the default equation and tells OMEGA+ to instead try and reach the 
# desired current day surface mass density, defined in another array
# (this is specified inside the inflow array)
#
# For each infall episode, exp_infall --> [Norm, t_max, timescale]
# 'exp_infall':[[-1, 0.1e9, 0.1e9], [A2, t_2*1e9, infall_2*1e9]]
# Justification: A1=-1 for auto-normalization to target mass; A2=1 as relative scale—unchanged but noted for two-infall balance.
# Contentious: Fixed A2=1 assumes equal normalization; variable A2 (0.5-2) could test mass ratios, but kept simple.
# References: Spitoni et al. (2019) for A2/A1 ~1-5; Chiappini et al. (2001) for normalization in equations.
############################################################
A2: -1
A1: -1
